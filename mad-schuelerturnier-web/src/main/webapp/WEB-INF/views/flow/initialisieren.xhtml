<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="../../layouts/100.xhtml">

    <ui:define name="main">
        <div id="main">
            <div class="page_margins">
                <div class="page">
                    <div class="inset">

                        <h:form id="form">

                        <p:messages/>

                            <p:accordionPanel id="ac" activeIndex="10" >
                                <p:tab title="Neues Spiel initialisieren">

                                    <h:panelGroup id="button" layout="block">
                                        <p:commandButton id="submit" value="Initialisieren" action="save" execute="@form" update="@form"/>
                                    </h:panelGroup>


                                </p:tab>
                                <p:tab title="Spiel aus XLS hochladen">


                                    <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                                                  multiple="false" auto="true" ajax="true"
                                                  widgetVar="dialogUpLoad" mode="advanced"
                                                  oncomplete="document.getElementById('form1:ok').click()"/>
                                    <br/>
                                    <!--kruecke zum feuern der weiterleitungsaction nach upload-->
                                    <p:commandButton id="ok" value="Initialisieren" action="ok" style="display: none"/>

                                </p:tab>
                                <p:tab  title="Spiel von XLS aus Dropbox laden">

                                    <h:panelGrid columns="1" id="dropbox_panel" rendered="#{! dropboxBackingBean.isConnected()}"> 

                                    <br/>
                                        <p:column>
                                    1) Link klicken:
                                    <a href="#{dropboxBackingBean.getURL()}" target="_blank" >Bei Dropbox anmelden und Key kopieren</a>
                                    </p:column>
                                    <p:column>
                                    2) Kopierten Key einfuegen:
                                    <p:inputText id="dropboxtoken" value="#{dropboxBackingBean.token}"/>
                                    </p:column><p:column>
                                    3) Zum Bestaetigen klicken
                                    <p:commandButton id="save" value="eingeben" actionListener="#{dropboxBackingBean.save()}" ajax="true" update=":form"/>
                                      </p:column>
                                    </h:panelGrid>

                                    <h:panelGrid columns="1" id="dropbox_panel_chose" rendered="#{dropboxBackingBean.isConnected()}" > 



                                        <ui:repeat value="#{dropboxBackingBean.fileList}" var="file">
                                            <p:column>
                                                #{file}
                                            </p:column>
                                        </ui:repeat>




                                    </h:panelGrid>

                                </p:tab>
                            </p:accordionPanel>




                        </h:form>

                    </div>
                    <br/>
                </div>
            </div>

        </div>
    </ui:define>

</ui:composition>
