<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                template="../../../layouts/100.xhtml">


    <ui:define name="caption">
        <p>Mannschaftsliste</p>
    </ui:define>

    <ui:define name="main">

        <div id="main">

            <div class="page_margins">
                <div class="page">
                    <div class="inset">

                        <p:messages/>
                        <h:form id="form1" enctype="multipart/form-data">


                            <p:growl id="msg" showDetail="true" for="feedback"/>

                            <p:fieldset id="leg" legend="CSV Import der Spiele">

                                <h:panelGrid columns="2" id="inputelements">

                                    <p:fileUpload fileUploadListener="#{fileUploadHandler.handleFileUpload}"
                                                  multiple="false" auto="true" update="msg" ajax="false"
                                                  mode="advanced"/>
                                    <br/>


                                    <p:dialog modal="true" widgetVar="statusDialog" header="Status" draggable="false"
                                              closable="false" resizable="false">
                                        <p:graphicImage value="/app/resources/static/images/ajaxloadingbar.gif"/>
                                    </p:dialog>

                                    <h:form id="form">

                                        <p:commandButton id="downloadLink" value="Download" ajax="false"
                                                         onclick="PrimeFaces.monitorDownload(start, stop)"
                                                         icon="ui-icon-arrowthichk-s">
                                            <p:fileDownload value="#{fileDownloadController.file}"/>
                                        </p:commandButton>

                                    </h:form>

                                    <script type="text/javascript">
                                        function start() {
                                            statusDialog.show();
                                        }

                                        function stop() {
                                            statusDialog.hide();
                                        }
                                    </script>
                                    <br/> <br/> <br/>
                                    <p:inputTextarea name="text" id="text" rows="20" cols="90"
                                                     value="#{spielImportExportDelegate.text}" autoResize="false"
                                                     disabled="#{spielImportExportDelegate.isBlockField()}"/>

                                    <br/>

                                    <p:commandButton widgetVar="submit" id="submit" value="Eintragen Beide"
                                                     action="#{spielImportExportDelegate.eintragenBeide()}" ajax="true"
                                                     execute="@form" update="@form"
                                                     disabled="#{spielImportExportDelegate.isBlockField()}"/>
                                    <p:commandButton widgetVar="submita" id="submita" value="Eintragen Bestaetigt"
                                                     action="#{spielImportExportDelegate.eintragenBestaetigt()}"
                                                     ajax="true" execute="@form" update="@form"
                                                     disabled="#{spielImportExportDelegate.isBlockField()}"/>
                                    <p:commandButton widgetVar="submits" id="submitd" value="Eintragen Eingetragen"
                                                     action="#{spielImportExportDelegate.eintragen()}" ajax="true"
                                                     execute="@form" update="@form"
                                                     disabled="#{spielImportExportDelegate.isBlockField()}"/>

                                </h:panelGrid>

                            </p:fieldset>


                            <p:blockUI id="blocker" block="leg" trigger="submit">
                                <p:graphicImage value="/app/resources/static/images/ajax-loader.gif"/>
                            </p:blockUI>

                        </h:form>

                    </div>
                    <br/>
                </div>
            </div>

        </div>
    </ui:define>

</ui:composition>
